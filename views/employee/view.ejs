<%- include('../partials/header') %>
  <%- include('../partials/navbar') %>
    <div class="col-md-10 p-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="fw-bold">พนักงาน</h4>
    </div>
      <p><a href="/employee">หน้าหลัก</a> / ข้อมูลพนักงาน</p>

      <div class="card p-4">

        <div class="text-end">
          <button type="button" class="btn-close" aria-label="Close"></button>
        </div>

        <div class="container mt-4">
          <div class="row">

            <!-- รูปโปรไฟล์ -->
            <div class="col-md-4 d-flex justify-content-center mb-4">
              <div style="position: relative; width: 120px; height: 120px;">
                <img id="profileImage"
                  src="data:image/jpeg;base64,<%= Buffer.from(employee.emp_pic).toString('base64') %>" alt="Profile"
                  class="rounded-circle border" style="width: 120px; height: 120px; object-fit: cover;">

                <input type="file" id="fileInput" style="display: none;" accept="image/*"
                  onchange="previewImage(event)">
              </div>
            </div>

            <!-- ฟอร์ม -->
            <div class="col-md-8">
              <div class="row mb-2">
                <div class="col-md-3">ชื่อ - สกุล :</div>
                <div class="col-md-9">
                  <%= employee.emp_name %>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">ตำแหน่ง :</div>
                <div class="col-md-9">
                  <%= employee.jobpos_name %>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">Email :</div>
                <div class="col-md-9">
                  <%= employee.emp_email %>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">เบอร์โทร :</div>
                <div class="col-md-9">
                  <%= employee.emp_tel %>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">ที่อยู่ :</div>
                <div class="col-md-9">
                  <%= employee.emp_address %>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">วันเกิด :</div>
                <div class="col-md-9"><%= employee.emp_birthday.toISOString().slice(0, 10) %></div>
                
              </div>
              <div class="row mb-2">
                <div class="col-md-3">วันที่เริ่มงาน :</div>
                <div class="col-md-9"><%= employee.emp_startwork.toISOString().slice(0, 10) %></div>
              </div>


            </div>

            <h4 class="fw-bold">ลงงานทั้งหมด</h4>
            <div class="row">
              <div class="col-md-4 mb-3">
                <div class="card card-green">
                  <div class="card-body">
                    <h5 class="card-title">มาตรงเวลา</h5>
                    <h1 class="text-end">2</h1>
                    <p class="card-text text-end">ครั้ง</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <div class="card card-yellow">
                  <div class="card-body">
                    <h5 class="card-title">มาสาย</h5>
                    <h1 class="text-end">3</h1>
                    <p class="card-text text-end">ครั้ง</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <div class="card card-red">
                  <div class="card-body">
                    <h5 class="card-title">ขาด/ลา</h5>
                    <h1 class="text-end">94</h1>
                    <p class="card-text text-end">ครั้ง</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <p class="fw-bold text-danger fs-6">ลาป่วยได้อีก 20 วัน ลากิจ/ขาดงานได้อีก 1 วัน</p>
        <div class="d-flex justify-content-end">
          <form action="/employee/edit/<%= employee.emp_id %>" method="get" style="display:inline;">
            <button type="submit" class="btn btn-warning ms-2 " style="cursor: pointer;">อัพเดท</button>
          </form>
          <% if (user) { %>
            <% if (user.jobpos_id===1||user.jobpos_id===2 ||user.jobpos_id===3 ) { %> <!-- สมมุติ 1 = Admin -->
              <button type="submit" class="btn btn-danger ms-2" data-bs-toggle="modal"
                data-bs-target="#confirmRejectModal">ลบ</button>
              
                <% } %>
              <% } %>

        </div>
        </form>

      </div>
    </div>

    <!-- Modal ยืนยันการปฏิเสธ -->
    <div class="modal fade" id="confirmRejectModal" tabindex="-1" aria-labelledby="confirmRejectModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content text-center p-4" style="max-width: 500px; margin: auto;">
          <div class="modal-body"
            style="min-height: 180px; display: flex; flex-direction: column; justify-content: center;">
            <p class="fs-5 fw-bold mb-4">ระบบจะทำการลบข้อมูล</p>
            <div class="d-flex justify-content-center gap-3">
              <form action="/employee/delete/<%= employee.emp_id %>" method="POST" style="display:inline;">
                <button type="submit" class="btn btn-danger px-4" id="confirmRejectBtn">ยืนยัน</button>
              </form>
              <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">ยกเลิก</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%- include('../partials/footer') %>