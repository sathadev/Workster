<%- include('../partials/header') %>
<%- include('../partials/navbar') %>

<div class="col-md-10 p-4">
  <div class="card p-4">
    <div class="text-end">
      <button type="button" class="btn-close" aria-label="Close"></button>
    </div>
    <div class="container mt-4">
      <div class="row">
        <!-- รูป -->
        <div class="col-md-4 d-flex justify-content-center mb-4">
          <div style="position: relative; width: 140px; height: 140px;">
            <img id="profileImage"
              src="data:image/jpeg;base64,<%= Buffer.from(employee.emp_pic).toString('base64') %>"
              alt="Profile"
              class="rounded-circle border"
              style="width: 140px; height: 140px; object-fit: cover;">

            <div onclick="document.getElementById('fileInput').click();" style="position: absolute; bottom: 0; right: 0;
                background-color: #1E56A0; border-radius: 50%;
                width: 30px; height: 30px; display: flex;
                align-items: center; justify-content: center;
                cursor: pointer; border: 2px solid #fff;">
              <i class="fa-solid fa-plus text-white"></i>
            </div>

            <input name="emp_pic" type="file" id="fileInput" style="display: none;" accept="image/*"
              onchange="previewImage(event)">
          </div>
        </div>

        <!-- ฟอร์ม -->
        <div class="col-md-8">
          <form action="/employee/edit/<%= employee.emp_id %>" method="POST" enctype="multipart/form-data">
            <div class="row mb-2">
              <div class="col-md-3">ชื่อ - สกุล :</div>
              <div class="col-md-9"><input value="<%= employee.emp_name %>" type="text" class="form-control" name="emp_name"></div>
            </div>
            <div class="row mb-2">
              <div class="col-md-3">ตำแหน่ง :</div>
              <div class="col-md-9"><input value="<%= employee.emp_jobpos %>" type="text" class="form-control" name="emp_jobpos"></div>
            </div>
            <div class="row mb-2">
              <div class="col-md-3">Email :</div>
              <div class="col-md-9"><input value="<%= employee.emp_email %>" type="email" class="form-control" name="emp_email"></div>
            </div>
            <div class="row mb-2">
              <div class="col-md-3">เบอร์โทร :</div>
              <div class="col-md-9"><input value="<%= employee.emp_tel %>" type="tel" class="form-control" name="emp_tel"></div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">ที่อยู่ :</div>
              <div class="col-md-9"><input value="<%= employee.emp_address %>" type="text" class="form-control" name="emp_address"></div>
            </div>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-success ms-2">ยืนยัน</button>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>
</div>

<script>
  function previewImage(event) {
    const reader = new FileReader();
    reader.onload = function () {
      document.getElementById('profileImage').src = reader.result;
    }
    reader.readAsDataURL(event.target.files[0]);
  }
</script>

<%- include('../partials/footer') %>
