<%- include('../partials/header') %>
<%- include('../partials/navbar') %>

<div class="col-md-10 p-4">
  <h4 class="fw-bold">รายการคำขอลา</h4>
  <p>หน้าหลัก</p>

  <div class="table-responsive">
    <table class="table table-hover table-bordered text-center align-middle">
      <thead class="table-light">
        <tr>
          <th>ชื่อ - สกุล</th>
          <th>ตำแหน่ง</th>
          <th>หมายเหตุ</th>
          <th>วันที่เริ่ม</th>
          <th>วันที่สิ้นสุด</th>
          <th>สถานะ</th>
          <th>ดำเนินการ</th>
        </tr>
      </thead>
      <tbody>
        <% if (leaveworks.length > 0) { %>
          <% leaveworks.forEach(function(leave) { %>
            <tr>
              <td><%= leave.emp_name %></td>
              <td><%= leave.jobpos_name %></td>
              <td><%= leave.leavework_description %></td>
              <td><%= leave.leavework_datestart.toISOString().slice(0, 10) %></td>
              <td><%= leave.leavework_end.toISOString().slice(0, 10) %></td>
              <td>
                <% if (leave.leavework_status === 'pending') { %>
                  <span class="badge bg-warning text-dark">รอดำเนินการ</span>
                <% } else if (leave.leavework_status === 'approved') { %>
                  <span class="badge bg-success">อนุมัติ</span>
                <% } else { %>
                  <span class="badge bg-danger">ไม่อนุมัติ</span>
                <% } %>
              </td>
              <td>
                <% if (leave.leavework_status === 'pending') { %>
                  <div class="d-flex justify-content-center gap-2">
                    <a href="/leave-work/approve/<%= leave.leavework_id %>" class="btn btn-success btn-sm">อนุมัติ</a>
                    <a href="/leave-work/reject/<%= leave.leavework_id %>" class="btn btn-danger btn-sm">ไม่อนุมัติ</a>
                  </div>
                <% } else { %>
                  <span class="text-muted">-</span>
                <% } %>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="7" class="text-muted">ไม่มีข้อมูลคำขอลา</td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<%- include('../partials/footer') %>
